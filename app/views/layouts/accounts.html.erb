<!DOCTYPE html>
<html>
  <head>
    <title>Project Hamburg - 财务</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%= stylesheet_link_tag    "application", :media => "all" %>
    <%= stylesheet_link_tag    "accounts", :media => "all" %>
    <%= javascript_include_tag "jquery" %>
    <%= csrf_meta_tags %>
  </head>

  <body>

    <div id="wrap">

      <div class="navbar navbar-static-top">
        <div class="navbar-inner">
          <div class="container">
            <ul class="nav">
              <li><a class="brand" href="/">Hamburg</a></li>
            </ul>
            <ul class="nav pull-right">
               <% if user_signed_in? %>
                  <li><a href="#">我的目标</a></li>
                  <li><a href="#">我的预算</a></li>
                  <li class="active"><%= link_to "我的财务", accounts_path %></li>
                  <li><%= link_to '记帐', new_transaction_path, :remote=>true %></li>
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= current_user.email %><b class="caret"></b></a>
                      <ul class="dropdown-menu">
                        <li>
                          <a href="#">个人信息</a>
                        </li>
                        <li>
                          <a href="#">设置</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                          <%= link_to "退出", destroy_user_session_path, :method=>:delete %>
                        </li>
                      </ul>
                  </li>
               <% else %>
                  <li><%= link_to "登录", new_user_session_path %></li>
                  <li><%= link_to "注册", new_user_registration_path %></li>
               <% end %>
            </ul>
          </div>
        </div>
      </div>


      <div class="row-fluid">
        <div class="span8 offset2">
          <div class="well" style="margin-top:30px">
            资产总额1000000元，负债10000元。净资产为990000元。
          </div>
        </div>
      </div>

      <div class="row-fluid">
        <div class="span8 offset2">
          <div class="row-fluid">
              <div class="span4">
                  <div class="well sidebar-nav accounts-sidebar">  
                      <ul class="nav nav-list">  
                          <li class="nav-header">我的帐户
                              <%= link_to new_account_path, :class=>"pull-right", :remote=>true do %>
                                  <i class="icon-edit" style="margin-top:3px"></i><span style="font-size:12px;">添加</span>
                              <% end %>
                          </li>  
                          <li class="divider"></li>
                          <li><a href="#" data-toggle="collapse" data-target="#accounts-cash" class="accounts-sidebar-header">现金</a> 
                              <ul id="accounts-cash" class="collapse in">
                                  <li id="accounts-cash-placeholder">还没有现金帐户。<%= link_to "添加", new_account_path, :remote=>true %></li>
                              </ul>
                          </li>  
                          <li class="divider"></li>
                          <li><a href="#" data-toggle="collapse" data-target="#accounts-savings" class="accounts-sidebar-header">储蓄</a> 
                              <ul id="accounts-savings" class="collapse in">
                                  <li id="accounts-savings-placeholder">还没有储蓄帐户。<%= link_to "添加", new_account_path, :remote=>true %></li>
                              </ul>
                          </li>
                          <li class="divider"></li>
                          <li><a href="#" data-toggle="collapse" data-target="#accounts-credit" class="accounts-sidebar-header">信用</a> 
                              <ul id="accounts-credit" class="collapse in">
                                  <li id="accounts-credit-placeholder">还没有信用帐户。<%= link_to "添加", new_account_path, :remote=>true %></li>
                              </ul>
                          </li>  
                          <li class="divider"></li>
                          <li><a href="#" data-toggle="collapse" data-target="#accounts-investment" class="accounts-sidebar-header">投资</a> 
                              <ul id="accounts-investment" class="collapse in">
                                  <li id="accounts-investment-placeholder">还没有投资帐户。<%= link_to "添加", new_account_path, :remote=>true %></li>
                              </ul>
                          </li>  
                          <li class="divider"></li>
                          <li><a href="#" data-toggle="collapse" data-target="#accounts-property" class="accounts-sidebar-header">房产</a> 
                              <ul id="accounts-property" class="collapse in">
                                  <li id="accounts-property-placeholder">还没有房产。<%= link_to "添加", new_account_path, :remote=>true %></li>
                              </ul>
                          </li>  
                      </ul>  
                  </div> 
            </div>

            <script type="text/javascript">
                <% @accounts.each do |account| %>
                  <% if account.category === "储蓄帐户" %>
                    $("#accounts-savings-placeholder").remove();
                    $("#accounts-savings").append('<%= escape_javascript(render_sidebar_item_for account) %>');
                  <% elsif account.category === "信用帐户" %>
                    $("#accounts-credit-placeholder").remove();
                    $("#accounts-credit").append('<%= escape_javascript(render_sidebar_item_for account) %>');
                  <% elsif account.category === "现金" %>
                    $("#accounts-cash-placeholder").remove();
                    $("#accounts-cash").append('<%= escape_javascript(render_sidebar_item_for account) %>');
                  <% elsif account.category === "理财帐户" %>
                    $("#accounts-investment-placeholder").remove();
                    $("#accounts-investment").append('<%= escape_javascript(render_sidebar_item_for account) %>');
                  <% end %>
                <% end %>
            </script>

            <div class="span8">
                <%= yield %>
            </div>
        </div>
      </div>
    </div>

    </div>

    <div id="new-transaction"/>
    <div id="new-account"/>

    <div id="push"></div>
    </div>

    <div id="footer">
      <div class="container">
        <div class="row">
          <div class="span1 offset2"><a href="#">关于我们</a></div>
          <div class="span1 offset1"><a href="#">隐私条款</a></div>
          <div class="span1 offset1"><a href="#">联系我们</a></div>
          <div class="span3 offset1">北京xx科技发展有限公司</div>
        </div>
      </div>
    </div>

    <%= javascript_include_tag "application" %>
    <%= javascript_include_tag "jquery.ui.datepicker-zh-CN" %>
    <%= javascript_include_tag "flot/jquery.flot" %>
    <%= javascript_include_tag "flot/jquery.flot.time" %>
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="flot/excanvas.min.js"></script><![endif]-->

  </body>
</html>
