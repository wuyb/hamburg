<% if @transaction.errors.any? %>
  $(".help-inline").remove();
  $('div.error > input').unwrap();
  <%- @transaction.errors.messages.each do |error| %>
    var field_id = "transaction_" + '<%= error[0] %>';
    $("#" + field_id).wrap('<div class="control-group error" />');
    $("#" + field_id).after('<span class="help-inline">&nbsp;<%= error[1].join(',') %></span>');
  <% end -%>
<% else %>
  $('#new-transaction-modal').modal('hide');
  $('#new-transaction-modal').remove();
  if ($('#accounts-table')) {
    $('#account_<%= @transaction.account.id %>').replaceWith('<%= escape_javascript(render :partial=>@transaction.account) %>');
    $('#account_<%= @transaction.account.id %> > td').effect("highlight", {}, 2000);
    <% if !@transaction.to_account.nil? %>
      $('#account_<%= @transaction.to_account.id %>').replaceWith('<%= escape_javascript(render :partial=>@transaction.to_account) %>');
      $('#account_<%= @transaction.to_account.id %> > td').effect("highlight", {}, 2000);
    <% end %>
  }
<% end %>
